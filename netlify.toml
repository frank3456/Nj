# 1. Clean article slugs (MUST be first)
[[redirects]]
  from = "/:slug"
  to = "/article.html?slug=:slug"
  status = 200

# 2. Category
[[redirects]]
  from = "/category/:category"
  to = "/category.html?cat=:category"
  status = 200

# 3. Search
[[redirects]]
  from = "/search"
  to = "/search.html?q=:splat"
  status = 200

# 4. Admin
[[redirects]]
  from = "/admin"
  to = "/admin.html"
  status = 200

# 5. Prerender for bots (only if NOT matched above)
[[redirects]]
  from = "/*"
  to = "https://service.prerender.io/:splat"
  status = 200
  force = true
  conditions = { User-Agent = [
    "Twitterbot",
    "facebookexternalhit",
    "WhatsApp",
    "Googlebot",
    "bingbot",
    "LinkedInBot",
    "Slackbot",
    "TelegramBot",
    "Discordbot",
    "Applebot"
  ] }
  headers = { "X-Prerender-Token" = "${PRERENDER_TOKEN}" }

# 6. SPA Fallback (ALWAYS last)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
